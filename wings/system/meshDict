/*--------------------------------*- C++ -*----------------------------------*\
| =========                 |                                                |
| \\      /  F ield         | cfMesh: A library for mesh generation          |
|  \\    /   O peration     |                                                |
|   \\  /    A nd           | Author: Franjo Juretic                         |
|    \\/     M anipulation  | E-mail: franjo.juretic@c-fields.com            |
\*---------------------------------------------------------------------------*/

FoamFile
{
    version   2.0;
    format    ascii;
    class     dictionary;
    location  "system";
    object    meshDict;
}

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

surfaceFile "domain.stl";

maxCellSize 1.0;

refinementLevel 5;

nBoundaryLayers 10;

le_p0 (0.0 0.0 0.0);

le_p1 (0.0 0.0 3.0);

localRefinement
{
    wing_upper
    {
        additionalRefinementLevels $refinementLevel;
    }
    wing_lower
    {
        additionalRefinementLevels $refinementLevel;
    }
    tip
    {
        additionalRefinementLevels #calc "$refinementLevel + 2";
    }
    te
    {
        additionalRefinementLevels #calc "$refinementLevel + 1";
    }
}

objectRefinements
{
    le
    {
      type line;
      additionalRefinementLevels #calc "$refinementLevel + 2";
      p0 $le_p0;
      p1 $le_p1;
    }
}

renameBoundary
{
  defaultName inout;
  defaultType patch;
  newPatchNames
  {
    "(wing.*|te|tip)"
    {
      newName wing;
      type wall;
    }
    zMin
    {
      newName sym;
      type symmetry;
    }
  }
}

boundaryLayers
{
  patchBoundaryLayers
  {
    "(wing.*|tip|te)"
    {
      allowDiscontinuity 1;
      nLayers $nBoundaryLayers;
      thicknessRatio 1.3;
      //maxFirstLayerThickness 1e-4;
    }
  }

  optimiseLayer 1;

  optimisationParameters
  {
      nSmoothNormals 3;
      maxNumIterations 2;
      featureSizeFactor 0.4;
      reCalculateNormals 1;
      relThicknessTol 0.1;
  }

}